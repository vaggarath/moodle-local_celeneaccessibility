{"version":3,"file":"tts.min.js","sources":["../src/tts.js"],"sourcesContent":["export const init = (language) =>{\ndocument.body.addEventListener('contextmenu', (e)=>{\n\n    // const htmlEl = document.getElementsByTagName(\"html\")[0]; //this here equals to the HTML dom element\n    const bodyEl = document.body;\n\n    if(document.getElementById('context-menu')){\n        if(!e.target.classList.contains(\"item\")){ //vérifier qu'on ne click pas sur une option du menu\n          document.getElementById('context-menu').remove();\n        }\n    }\n\n    if(bodyEl.classList.contains('tts') && isClassForbiddenTts(e)){\n        //cf celeneaccessibility branch ne sactive que si on a activé l'option dans l'accessibilité\n        e.preventDefault();\n        if(e.target.innerText){\n            checkMenu(e);\n        }else if(!e.target.innerText || e.target.innerText === \"\"){ //s'il n'y a pas de texte\n            if(document.getElementById('context-menu')){ //il n'y a pas de texte mais un context menu était déjà ouvert ?\n                document.getElementById('context-menu').remove(); // alors on le vire\n            }\n        }\n    }\n\n    // créer le context menu\n        /**\n         *\n         * @param {*} event\n         */\n         function createMenu(event){\n            const synth = window.speechSynthesis;\n            const { clientX: mouseX, clientY: mouseY } = event;\n\n            const utterThis = new SpeechSynthesisUtterance(event.target.innerText);\n            const targetInnerHtml = event.target.innerHTML;\n\n            const contextMenu = document.createElement('div');\n            contextMenu.id = \"context-menu\";\n            const contextMenuItemFirst = document.createElement('div');\n            contextMenuItemFirst.id = \"item1\";\n            contextMenuItemFirst.innerText = \"Lire pour moi (audio)\";\n            contextMenuItemFirst.classList.add('item');\n            contextMenuItemFirst.onclick = () =>{\n                e.preventDefault();\n                createOptionsBar(event);\n                //default 'fr-FR';\n                utterThis.lang = language && language === \"french\"\n                    ? \"fr-FR\"\n                    : language && language === \"english\"\n                        ? \"en-US\"\n                        : \"fr-FR\";\n                utterThis.rate = getRateValueTts() ? getRateValueTts() : 1;\n                utterThis.pitch = getPitchValue() ? getPitchValue() : 1;\n                synth.speak(utterThis);\n\n                // const words = event.target.innerText.split(\" \");\n                utterThis.addEventListener('boundary', (e)=>{\n                    if (e.name === 'sentence') {\n                        // we only care about word boundaries\n                        return;\n                    }\n\n                    const wordStart = e.charIndex;\n                    let wordLength = e.charLength;\n                    if (wordLength === undefined) {\n                        // Safari\n                        const match = event.target.innerText.substring(wordStart).match(/^[a-z\\d']*/i);\n                        wordLength = match[0].length;\n                    }\n                    // wrap word in <mark> tag\n                    const wordEnd = wordStart + wordLength;\n                    const word = event.target.innerText.substring(wordStart, wordEnd);\n                    let markedText = event.target.innerText.substring(0, wordStart);\n                    markedText+= '<mark>' + word + '</mark>';\n                    markedText+= event.target.innerText.substring(wordEnd);\n\n                    event.target.innerHTML = markedText;\n                });\n\n\n                event.target.classList.add(\"highlight\");\n                contextMenu.remove();\n\n                utterThis.addEventListener('end', () => { //les events se mettent sur l'utterance\n                    document.querySelectorAll(\"mark\").forEach(div => {\n                        const span = document.createElement(\"span\");\n                        span.innerText = div.innerText;\n                        div.replaceWith(span);\n                      });\n                    event.target.classList.remove(\"highlight\");\n                    event.target.innerHTML = targetInnerHtml;\n                    // pause.remove();\n                    removeOptionsBar();\n                });\n            };\n            const contextMenuItemSecond = document.createElement('div');\n            contextMenuItemSecond.id = \"item2\";\n            contextMenuItemSecond.innerText = \"copier\";\n            contextMenuItemSecond.classList.add('item');\n            contextMenuItemSecond.onclick = (e) =>{\n                e.preventDefault();\n                navigator.clipboard.writeText(event.target.innerText).then(()=>{\n                    new Toast(\"Texte copié : \" + \"\\n\" + event.target.innerText, \"#00b894\" , 2500);\n                    contextMenu.remove();\n                });\n            };\n\n            const contextMenuItemFifth = document.createElement('div');\n            contextMenuItemFifth.classList.add('item');\n            contextMenuItemFifth.innerText = \"Inverser les couleurs (alpha)\";\n            contextMenuItemFifth.onclick = () =>{\n                event.preventDefault();\n                const elementToChange = event.target;\n                elementToChange.style.filter = elementToChange.style.filter === \"invert(1)\" ? \"invert(0)\" :\"invert(1)\";\n                contextMenu.remove();\n            };\n\n            const contextMenuItemSixth = document.createElement('div');\n            contextMenuItemSixth.classList.add('item');\n            contextMenuItemSixth.innerText = \"Recharger la page\";\n            contextMenuItemSixth.onclick = () =>{\n                event.preventDefault();\n                document.location.reload();\n            };\n\n            let contextMenuItemThird = null;\n            if(typeof window.getSelection !== \"undefined\" && window.getSelection !== \"\"){\n                const text = getSelectedText();\n                if(text && text !== \"\"){\n                    contextMenuItemThird = document.createElement('div');\n                    contextMenuItemThird.innerText = \"copier la selection\";\n                    contextMenuItemThird.classList.add('item');\n                    contextMenuItemThird.onclick = (e) =>{\n                        e.preventDefault();\n                        new Toast(\"Sélection copiée : \" + \"\\n\" + text, \"#00b894\" , 2500);\n                        navigator.clipboard.writeText(text).then(()=>{\n                            contextMenu.remove();\n                        });\n                    };\n                }\n            }\n\n            const contextMenuItemFourth = document.createElement('div');\n            contextMenuItemFourth.innerText = \"Tout sélectionner\";\n            contextMenuItemFourth.classList.add('item');\n            contextMenuItemFourth.onclick = (e) =>{\n                e.preventDefault();\n                const doc = document.body;\n                let range, selection;\n                selection = window.getSelection();\n                range = document.createRange();\n                range.selectNodeContents(doc);\n                selection.removeAllRanges();\n                selection.addRange(range);\n                contextMenu.remove();\n            };\n\n            //titre to append\n            const contextTitle = document.createElement('p');\n            contextTitle.innerText = \"Options\";\n            contextTitle.classList.add('contextTitle', 'text-center');\n            // contextTitle.prepend(logo); //on ajoute le logo celene\n\n            //on append\n            contextMenu.append(contextTitle);\n            contextMenu.append(contextMenuItemFirst);\n            contextMenu.append(contextMenuItemSecond);\n            if(!typeof window.getSelection !== \"undefined\" && contextMenuItemThird){\n                contextMenu.append(contextMenuItemThird);\n            }\n            contextMenu.append(contextMenuItemFourth);\n\n            // if(htmlEl.classList.contains('dark')){\n            //    contextMenu.append(contextMenuItemFifth);\n            // }\n\n\n            contextMenu.append(contextMenuItemSixth);\n            document.body.append(contextMenu);\n\n            const posX = window.innerWidth - mouseX >= 250 ? mouseX : mouseX-200;\n            const posY = window.innerHeight - mouseY >= 200 ? mouseY : mouseY-200;\n            // console.log(window.innerHeight - mouseY);\n\n            contextMenu.style.top = `${posY}px`;\n            contextMenu.style.left = `${posX}px`;\n        }\n\n\n    /**\n     *\n     * @returns selected text\n     */\n    function getSelectedText() {\n        //check si du text est surligné, si oui le récupérer pour permettre\n        //une copie plus étendu que le event.target (copier la selection)\n        let text = \"\";\n        if (typeof window.getSelection != \"undefined\") {\n            text = window.getSelection().toString();\n        } else if (typeof document.selection != \"undefined\" && document.selection.type == \"Text\") {\n            text = document.selection.createRange().text;\n        }\n        return text;\n    }\n\n\n    // vérifier que le menu existe. S'il existe on le supprime et on le recréé\n    /**\n     *\n     * @param {*} e = event\n     */\n    function checkMenu(e){\n        const words = e.target.innerText.split(\" \");\n        if(document.getElementById('context-menu')){\n            document.getElementById('context-menu').remove();\n            createMenu(e, words);\n        }else{\n            createMenu(e, words);\n        }\n    }\n\n\n    // create lecture options\n    /**\n     *\n     * @return bar\n     */\n    function createOptionsBar(){\n        const bar = document.createElement('div');\n        bar.classList.add('options-bar');\n        bar.id = \"options-bar\";\n\n        //bouton pour arrêter\n        const play = document.createElement('button');\n        // play.innerHTML = \"<span>ARRÊTER</span>\";\n        const spanArret = document.createElement('span');\n        spanArret.innerText = \"ARRÊTER\";\n        play.append(spanArret);\n        play.classList.add('play-btn');\n        play.onclick = (e) =>{\n            e.preventDefault();\n            if(window.speechSynthesis.speaking){\n                window.speechSynthesis.cancel(); //on arrête\n            }\n        };\n\n        const pause = document.createElement('button');\n        const spanPause = document.createElement('span');\n        spanPause.innerText = \"PAUSE\";\n        pause.append(spanPause);\n        pause.classList.add('play-btn');\n        pause.onclick = (e) =>{\n            e.preventDefault();\n            if(window.speechSynthesis.speaking && spanPause.innerText === \"PAUSE\"){\n                window.speechSynthesis.pause();\n                spanPause.innerText = \"REPRENDRE\";\n            }else if(window.speechSynthesis.paused && spanPause.innerText === \"REPRENDRE\"){\n                window.speechSynthesis.resume();\n                spanPause.innerText = \"PAUSE\";\n            }\n        };\n\n        bar.append(play);\n        bar.append(pause);\n        document.body.append(bar);\n    }\n\n    /**\n     * @return remove options bar\n     */\n    function removeOptionsBar(){\n        if(document.getElementById('options-bar')){\n            document.getElementById('options-bar').remove();\n        }\n    }\n});\n\nconst isClassForbiddenTts=(element)=>{\n    //liste des divs sur lesquelles on ne veut surtout pas changer la MEP avec le TTS\n    let doNotInclude;\n    const divToNotInclude = [\n        \"generalbox\",\n        \"secondary-navigation\",\n        \"navbar\",\n        \"nav\",\n        \"drawers\",\n        \"completion-info\",\n        \"card\"\n    ];\n    for(let i=0; i<divToNotInclude.length;i++){\n        if(\n            element.target.classList.contains(divToNotInclude[i]) ||\n            (element.target.getAttribute('role') && element.target.getAttribute('role') === \"main\")\n        ){\n            return false;\n        }else{\n            doNotInclude = true;\n        }\n    }\n    return doNotInclude;\n};\n\n//Unused at the moment. Not sure it should stay...\nconst getRateValueTts = () =>{\n    const settedValues = [\n        {\n            'class':'rate5',\n            'value': 0.5\n        },\n        {\n            'class':'rate10',\n            'value': 1\n        },\n        {\n            'class':'rate15',\n            'value': 1.5\n        },\n        {\n            'class':'rate20',\n            'value': 2\n        }\n    ];\n    for(let i=0;i<settedValues.length;i++){\n        if(document.body.classList.contains(settedValues[i].class)){\n            return settedValues[i].value;\n        }\n    }\n};\n//Unused at the moment. Not sure it should stay...\nconst getPitchValue = () =>{\n    const settedValues = [\n        {\n            'class':'pitch5',\n            'value': 0.5\n        },\n        {\n            'class':'pitch10',\n            'value': 1\n        },\n        {\n            'class':'pitch15',\n            'value': 1.5\n        },\n        {\n            'class':'pitch20',\n            'value': 2\n        }\n    ];\n    for(let i=0;i<settedValues.length;i++){\n        if(document.body.classList.contains(settedValues[i].class)){\n            return settedValues[i].value;\n        }\n    }\n};\n\n//virer le menu sur un click simple\ndocument.body.addEventListener('click', (e)=>{\n    if(document.getElementById('context-menu')){\n        if(!e.target.classList.contains(\"item\")){ //vérifier qu'on ne click pas sur une option du menu\n          document.getElementById('context-menu').remove();\n        }\n    }\n});\n\n//generation of a toast message to indicate : The copy has been done. The content of what was copied\nclass Toast {\n    constructor(textToDisplay,color,time){\n      this.message = textToDisplay;\n      this.color = color;\n      this.time = time;\n      this.element = null;\n\n      const element = document.createElement('div');\n      element.className = \"toast-notification\";\n      this.element = element;\n      const countElements = document.getElementsByClassName(\"toast-notification\");\n\n      element.style.opacity=0.8;\n\n      element.style.marginBottom = (countElements.length * 55) + \"px\";\n\n      element.style.backgroundColor = this.color;\n\n      const message = document.createElement(\"div\");\n      message.className = \"message-container\";\n      message.textContent = this.message;\n\n      element.appendChild(message);\n\n      const close = document.createElement(\"div\");\n      close.className = \"close-notification\";\n\n      const icon = document.createElement(\"i\");\n      icon.className = \"lni lni-close\";\n\n      close.appendChild(icon);\n\n      element.append(close);\n\n      document.body.appendChild(element);\n\n      setTimeout(function() {\n        element.remove();\n      }, this.time); //do not change time here, check the construct function. It shall be a parameter\n\n      close.addEventListener(\"click\",()=>{//if user wants to close before timeout\n        element.remove();\n      });\n    }\n  }\n};\n"],"names":["_exports","init","language","document","body","addEventListener","e","bodyEl","createMenu","event","synth","window","speechSynthesis","mouseX","clientX","mouseY","clientY","utterThis","SpeechSynthesisUtterance","target","innerText","targetInnerHtml","innerHTML","contextMenu","createElement","id","contextMenuItemFirst","classList","add","onclick","preventDefault","bar","play","spanArret","append","speaking","cancel","pause","spanPause","paused","resume","createOptionsBar","lang","rate","getRateValueTts","pitch","getPitchValue","speak","name","wordStart","charIndex","wordLength","charLength","undefined","substring","match","length","wordEnd","word","markedText","remove","querySelectorAll","forEach","div","span","replaceWith","getElementById","contextMenuItemSecond","navigator","clipboard","writeText","then","Toast","contextMenuItemFifth","elementToChange","style","filter","contextMenuItemSixth","location","reload","contextMenuItemThird","getSelection","text","toString","selection","type","createRange","getSelectedText","contextMenuItemFourth","range","doc","selectNodeContents","removeAllRanges","addRange","contextTitle","_typeof","posX","innerWidth","posY","innerHeight","top","concat","left","contains","isClassForbiddenTts","split","checkMenu","element","doNotInclude","divToNotInclude","i","getAttribute","settedValues","class","value","textToDisplay","color","time","_classCallCheck","this","message","className","countElements","getElementsByClassName","opacity","marginBottom","backgroundColor","textContent","appendChild","close","icon","setTimeout"],"mappings":"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"}